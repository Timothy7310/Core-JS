# Virtual DOM

## What is it?

`Virtual DOM` — это легковесный объект, который описывает структуру приложения. Объект `Virtual DOM` отображает своё дерево компонентов в браузерное `DOM-дерево`.   
Так фреймворк узнаёт, какой компонент соответствует какому `DOM-элементу` на странице. Это дерево хранится в памяти и `обновляется каждый раз при изменении данных в приложении`.   

Например, если наш интерфейс состоит из кнопок, нажатие на которые открывает модальные окна, то стартовый `Virtual DOM` будет содержать только компоненты кнопок.   
При отображении в браузере мы увидим эти кнопки. Если нажать на одну из них, то `Virtual DOM` обновится и будет содержать кнопки и модальное окно.   
Так как модального окна нет в браузере, фреймворк понимает, что нужно его дорисовать.


## Is the virtual DOM the same as the shadow DOM?

Нет,  `Virtual DOM` - это концепция программирования, реализованная React преимущественно для **повышения производительности** рендеринга,  
  `Shadow DOM` - это браузерная технология, разработанная для **определения области видимости переменных и CSS в веб-компонентах.**
  
## What is the difference between the virtual DOM and the real DOM?

`DOM` представляет HTML-документ в виде древовидной структуры, в которой каждый узел представляет часть документа (например, элемент, атрибут элемента или текст)  
Используя ванильный `JavaScript` и `DOM API`, вы можете получить доступ к любому понравившемуся элементу (например, используя `document.getElementById`) и обновить его напрямую.

Когда вы это делаете, браузер просматривает `DOM` и повторно отображает каждый узел - **даже если этот узел не изменился** с момента предыдущего рендеринга. Это довольно затратная операция

Представьте сценарий, в котором вам нужно обновить только один `tr` из 10 000 в `table`.  
Визуализация всех 10 000 `tr` почти наверняка приведет к падению кадров, что потенциально приведет к мерцанию таблицы и прерыванию работы пользователя.  

Вот тут-то и вступает в игру `Virtual DOM`

`React` повышает производительность вашего пользовательского интерфейса, создавая `Virtual DOM`, чтобы отслеживать все изменения, которые необходимо внести в реальный `DOM`.  
Каждый раз, когда состояние вашего приложения обновляется, `React` создает новый `Virtual DOM` и отличается от предыдущего `Virtual DOM`,   
чтобы определить, какие изменения необходимо сделать для эффективного обновлением `DOM`

Вкратце: `Virtual DOM` является просто *JS-объектом* который отражает состояние экрана. Далее React сравнивает новое дерево `Virtual DOM` со старым и строит разницу между ними.  
И только в этот момент начинается отрисовка нового состояния в реальный `DOM`.

**ВАЖНО**: Тот реальный `DOM`, который находится под контролем `React` (это все потомки элемента, в который мы рендерим корневой компонент), не может изменяться никем снаружи `React`.   
Если подобное произойдёт, то `React` не сможет нормально функционировать, ведь ему приходится отслеживать текущее состояние `DOM` для того, чтобы производить вычисления "диффа".  
Когда подобное происходит, `React` ругается и говорит, что ему мешают работать.

![image](https://user-images.githubusercontent.com/55184984/235679070-7e5f3d10-6f3b-4df7-9a42-a555fdc34e30.png)
